From f6afcc9cc1910b4a5751b8a6c5ded918fe30a549 Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sun, 8 Oct 2017 18:24:06 +0100
Subject: [PATCH 3/3] gpt-boot-generator: Do not automount the ESP on Solus

We use clr-boot-manager, thus it is undesirable to automount the ESP, as
we want it unmounted constantly. When required, clr-boot-manager will locate
the ESP, mount it, perform updates, and unmount it again.

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 src/gpt-auto-generator/gpt-auto-generator.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/gpt-auto-generator/gpt-auto-generator.c b/src/gpt-auto-generator/gpt-auto-generator.c
index ae0a8da..aa7aa1f 100644
--- a/src/gpt-auto-generator/gpt-auto-generator.c
+++ b/src/gpt-auto-generator/gpt-auto-generator.c
@@ -403,6 +403,9 @@ static int add_esp(DissectedPartition *p) {
                 return 0;
         }
 
+        log_debug("/boot automount is disabled on Solus, exiting.");
+        return 0;
+
         /* If /efi exists we'll use that. Otherwise we'll use /boot, as that's usually the better choice */
         esp = access("/efi/", F_OK) >= 0 ? "/efi" : "/boot";
 
-- 
2.14.2

