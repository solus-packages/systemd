From 168b7abd813606a40161655b286d17e0bee33b48 Mon Sep 17 00:00:00 2001
From: Auke Kok <auke-jan.h.kok@intel.com>
Date: Wed, 4 Apr 2018 09:56:53 -0700
Subject: [PATCH 01/36] Fix preprocessor issues with MS_MOVE not getting
 defined.

---
 src/basic/btrfs-util.c     | 1 +
 src/basic/chattr-util.c    | 1 +
 src/basic/missing.h        | 1 +
 src/core/load-fragment.c   | 1 +
 src/core/namespace.c       | 1 +
 src/import/import-raw.c    | 1 +
 src/import/import-tar.c    | 1 +
 src/import/pull-raw.c      | 1 +
 src/journal/journal-file.c | 1 +
 src/journal/journalctl.c   | 1 +
 src/shared/machine-image.c | 1 +
 src/tmpfiles/tmpfiles.c    | 1 +
 12 files changed, 12 insertions(+)

diff --git a/src/basic/btrfs-util.c b/src/basic/btrfs-util.c
index 3d30497f7..0594246fe 100644
--- a/src/basic/btrfs-util.c
+++ b/src/basic/btrfs-util.c
@@ -21,6 +21,7 @@
 #include <errno.h>
 #include <fcntl.h>
 #include <inttypes.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <linux/loop.h>
 #include <stddef.h>
diff --git a/src/basic/chattr-util.c b/src/basic/chattr-util.c
index 3635deee4..78cc0fc6c 100644
--- a/src/basic/chattr-util.c
+++ b/src/basic/chattr-util.c
@@ -22,6 +22,7 @@
 #include <fcntl.h>
 #include <sys/ioctl.h>
 #include <sys/stat.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 
 #include "chattr-util.h"
diff --git a/src/basic/missing.h b/src/basic/missing.h
index 1cc3f08e4..1871e5e66 100644
--- a/src/basic/missing.h
+++ b/src/basic/missing.h
@@ -41,6 +41,7 @@
 #include <sys/socket.h>
 #include <sys/stat.h>
 #include <sys/syscall.h>
+#include <sys/mount.h>
 #include <uchar.h>
 #include <unistd.h>
 
diff --git a/src/core/load-fragment.c b/src/core/load-fragment.c
index 1e3416c40..9e2e21741 100644
--- a/src/core/load-fragment.c
+++ b/src/core/load-fragment.c
@@ -21,6 +21,7 @@
 
 #include <errno.h>
 #include <fcntl.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <linux/oom.h>
 #if HAVE_SECCOMP
diff --git a/src/core/namespace.c b/src/core/namespace.c
index 0e9c7b8fb..9ccb3944e 100644
--- a/src/core/namespace.c
+++ b/src/core/namespace.c
@@ -25,6 +25,7 @@
 #include <sys/mount.h>
 #include <sys/stat.h>
 #include <unistd.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 
 #include "alloc-util.h"
diff --git a/src/import/import-raw.c b/src/import/import-raw.c
index f117c94da..9f2cb2043 100644
--- a/src/import/import-raw.c
+++ b/src/import/import-raw.c
@@ -18,6 +18,7 @@
   along with systemd; If not, see <http://www.gnu.org/licenses/>.
 ***/
 
+#include <sys/mount.h>
 #include <linux/fs.h>
 
 #include "sd-daemon.h"
diff --git a/src/import/import-tar.c b/src/import/import-tar.c
index 09c7654ad..540300fb3 100644
--- a/src/import/import-tar.c
+++ b/src/import/import-tar.c
@@ -18,6 +18,7 @@
   along with systemd; If not, see <http://www.gnu.org/licenses/>.
 ***/
 
+#include <sys/mount.h>
 #include <linux/fs.h>
 
 #include "sd-daemon.h"
diff --git a/src/import/pull-raw.c b/src/import/pull-raw.c
index 880cb84ba..730187bee 100644
--- a/src/import/pull-raw.c
+++ b/src/import/pull-raw.c
@@ -19,6 +19,7 @@
 ***/
 
 #include <curl/curl.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <sys/xattr.h>
 
diff --git a/src/journal/journal-file.c b/src/journal/journal-file.c
index 5643c0578..6e5d14227 100644
--- a/src/journal/journal-file.c
+++ b/src/journal/journal-file.c
@@ -20,6 +20,7 @@
 
 #include <errno.h>
 #include <fcntl.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <pthread.h>
 #include <stddef.h>
diff --git a/src/journal/journalctl.c b/src/journal/journalctl.c
index e0ad0e1d1..6fd0d4d6a 100644
--- a/src/journal/journalctl.c
+++ b/src/journal/journalctl.c
@@ -22,6 +22,7 @@
 #include <fcntl.h>
 #include <fnmatch.h>
 #include <getopt.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <locale.h>
 #include <poll.h>
diff --git a/src/shared/machine-image.c b/src/shared/machine-image.c
index 66eefb303..86306e31f 100644
--- a/src/shared/machine-image.c
+++ b/src/shared/machine-image.c
@@ -27,6 +27,7 @@
 #include <sys/file.h>
 #include <sys/stat.h>
 #include <unistd.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 
 #include "alloc-util.h"
diff --git a/src/tmpfiles/tmpfiles.c b/src/tmpfiles/tmpfiles.c
index f1890f326..bc3a0f673 100644
--- a/src/tmpfiles/tmpfiles.c
+++ b/src/tmpfiles/tmpfiles.c
@@ -25,6 +25,7 @@
 #include <getopt.h>
 #include <glob.h>
 #include <limits.h>
+#include <sys/mount.h>
 #include <linux/fs.h>
 #include <stdbool.h>
 #include <stddef.h>
-- 
2.17.0

